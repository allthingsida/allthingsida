# Solving the "Madame de Maintenon's Enigmatic Bouillotte Game" CTF

This is the walkthrough for the "Madame de Maintenon's Enigmatic Bouillotte Game" CTF challenge posted [here](https://hex-rays.com/blog/madame-de-maintenons-enigmatic-bouillotte-game/).


- Use the placeholder flag when following along: `CTF{WH4****************}`
- And here is the correct flag: `CTF{WH4Tev3nISb0u1llote}`

The video walkthrough can be found here: [https://youtu.be/OJT2e5XXVXI](https://youtu.be/OJT2e5XXVXI)

## Files

- [mdmebg-solved.c](./mdmebg-solved.c): Decompiled pseudo-code of the binary.
- [mdmebg.zip](./mdmebg.zip): The zip file containg the CTF's ELF binary.
- [frida.js](./frida.js): Frida script to compute the flag.
- [mdmebg-solved.i64](./mdmebg-solved.i64): Fully documented IDA database file.

## Using Frida

[Here](./frida.js) is a simple Frida script you can use to dump all the XOR bytes.

(Make sure Frida is installed first `pip install frida-tools`)

Run with:

```bash
frida -p $(pgrep PROCESS_NAME) -l frida.js
```

Make sure the CTF binary is running already, then replace `PROCESS_NAME` with the CTF binary name.

### Using ChatGPT

You can utilize the log generated by our Frida script above. Simply pass the log to ChatGPT and use its code interpreter to compute the flag for you.

Use the following prompt:

```
    Given this input:

    ```
    flag[0]=0x7d input[0]=0x43
    expected[0]=0x3e
    flag[1]=0x4 input[1]=0x54
    expected[1]=0x50
    flag[2]=0x4d input[2]=0x46
    expected[2]=0xb
    flag[3]=0xa2 input[3]=0x7b
    expected[3]=0xd9
    flag[4]=0x61 input[4]=0x57
    expected[4]=0x36
    flag[5]=0x92 input[5]=0x48
    expected[5]=0xda
    flag[6]=0x97 input[6]=0x34
    expected[6]=0xa3
    flag[7]=0x34 input[7]=0x2a
    expected[7]=0x60
    flag[8]=0xbf input[8]=0x2a
    expected[8]=0xda
    flag[9]=0x5c input[9]=0x2a
    expected[9]=0x2a
    flag[10]=0xe7 input[10]=0x2a
    expected[10]=0xd4
    flag[11]=0x84 input[11]=0x2a
    expected[11]=0xea
    flag[12]=0xf input[12]=0x2a
    expected[12]=0x46
    flag[13]=0xac input[13]=0x2a
    expected[13]=0xff
    flag[14]=0x37 input[14]=0x2a
    expected[14]=0x55
    flag[15]=0xd4 input[15]=0x2a
    expected[15]=0xe4
    flag[16]=0x5f input[16]=0x2a
    expected[16]=0x2a
    flag[17]=0xfc input[17]=0x2a
    expected[17]=0xcd
    flag[18]=0x87 input[18]=0x2a
    expected[18]=0xeb
    flag[19]=0x24 input[19]=0x2a
    expected[19]=0x48
    flag[20]=0xaf input[20]=0x2a
    expected[20]=0xc0
    flag[21]=0x4c input[21]=0x2a
    expected[21]=0x38
    flag[22]=0xd7 input[22]=0x2a
    expected[22]=0xb2
    flag[23]=0x74 input[23]=0x7d
    expected[23]=0x9
    ```
Please use code tool to xor the flag with the expected at the same index and return me the full string (use chr()) and Python.
```


ChatGPT will think and then generate this answer:

    ```python
    # The input data provided by the user
    flag = [0x7d, 0x4, 0x4d, 0xa2, 0x61, 0x92, 0x97, 0x34, 0xbf, 0x5c, 0xe7, 0x84, 0xf, 0xac, 0x37, 0xd4, 0x5f, 0xfc, 0x87, 0x24, 0xaf, 0x4c, 0xd7, 0x74]
    expected = [0x3e, 0x50, 0xb, 0xd9, 0x36, 0xda, 0xa3, 0x60, 0xda, 0x2a, 0xd4, 0xea, 0x46, 0xff, 0x55, 0xe4, 0x2a, 0xcd, 0xeb, 0x48, 0xc0, 0x38, 0xb2, 0x9]

    # XOR flag and expected, then convert to characters
    result = ''.join([chr(f ^ e) for f, e in zip(flag, expected)])
    result
    ```

    The resulting string after XORing the flag with the expected values is:

    ```
    CTF{WH4Tev3nISb0u1llote}
    ```
